from pwn import *

BINARY = './feather'
HOST, PORT = "pwn.chal.csaw.io", 5017
context.endian = 'little'

elf = ELF(BINARY)
context.binary = elf

if not args.REMOTE:
    libc = elf.libc
else:
    libc = ELF("./libc-2.31.so")

def start_binary():
    if not args.REMOTE:
        return process(BINARY)
    else:
        return remote(HOST, PORT)
        
def debug(bps):
    gdbscript = ''

    for bp in bps:
        gdbscript += 'b *0x{:x}'.format(bp)

    gdb.attach(p, gdbscript=gdbscript)

def go():
    p = start_binary()
    
    if not args.REMOTE and args.GDB:
        debug([0x4005dc])

    p.recv()
    # p.close()
go()