FROM python@sha256:f2fdaec50160418e0c2867ba3e254755edd067171725886d5d303fd7057bbf81 AS app
RUN pip install --no-cache-dir capstone==5.0.6 


RUN mkdir -p /challenge
WORKDIR /challenge
COPY sshellcode.py .
COPY flag.txt .

FROM pwn.red/jail

COPY --from=app / /srv
RUN mkdir -p /srv/app
COPY --chmod=555 ./run /srv/app/run

ENV JAIL_PIDS=10 JAIL_MEM=15M JAIL_TIME=120